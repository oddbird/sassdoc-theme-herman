{% macro code_block(language=none, content=none) %}
  {% set content = content if (content != none) else caller() %}
  {% set language = ['lang', language]|join('-') if language != none %}
  <pre data-sassdoc="hljs"><code{% if language %} class="{{ language }}"{% endif %}>{{ content }}</code></pre>
{% endmacro %}


{% macro source(item, type) %}
{%- call code_block(language='scss') -%}
  {%- if (type == 'variable') -%}
    {{ scss_variable(item) }}
  {%- elif (type == 'css') -%}
    {{ scss_css(item) }}
  {%- elif (type == 'function') or (type == 'mixin') -%}
    {{ scss_function_or_mixin(item) }}
  {%- endif -%}
{%- endcall -%}
{% endmacro %}


{% macro scss_variable(item) -%}
${{ item.context.name }}: {{ item.context.value }}{% if item.context.scope != 'private' %} !{{ item.context.scope }}{% endif %};
{%- endmacro %}


{% macro scss_function_or_mixin(item) -%}
@{{ item.context.type }} {{ item.context.name }}{% if item.parameter %}(
{%- for parameter in item.parameter %}
  ${{ parameter.name }}{% if parameter.type|lower == "arglist" %}...{% elif parameter.default %}: {{ parameter.default }}{% endif %}{% if not loop.last %},{% endif %}
{%- endfor %}
){% endif %} { /* ... */ }
{%- endmacro %}

{%- macro scss_css(item) -%}
{{ item.context.name }} {
  {{ item.context.value }}
}
{%- endmacro -%}


{% macro parameter(item) -%}
  {% if item.parameter %}
    <h5 class="item-subtitle">Parameters</h5>
    <table data-sassdoc="item-parameters">
      <thead>
        <tr scope="row">
          <th scope="col">Name</th>
          <th scope="col">Description</th>
          <th scope="col">Type</th>
          <th scope="col">Default value</th>
        </tr>
      </thead>
      <tbody>
        {%- for parameter in item.parameter %}
        <tr class="item__parameter">
          <td scope="row" data-label="name"><code>${{ parameter.name }}</code></td>
          <td data-label="desc">{% if parameter.description %}{{ parameter.description|safe }}{% endif %}</td>
          <td data-label="type"><code>{% if parameter.type %}{{ parameter.type }}{% endif %}</code></td>
          <td data-label="default">{% if not parameter.default %}
              &mdash;<span class="visually-hidden"> none</span>
            {% else %}
              <code>{{ parameter.default }}</code>
            {% endif %}
          </td>
        </tr>
        {%- endfor %}
      </tbody>
    </table>
  {% endif %}
{%- endmacro %}


{% macro require(item) -%}
  {% if item.require.length > 0 %}
  <h5 class="item-subtitle">Requires</h5>


  {% for require in item.require %}
    {% if require.external %}
      <li class="item-description">[external]
        {% if require.url %}
          <a href="{{ require.url }}"><code>{{ require.name }}</code></a> {{ require.description }}</li>
        {% else %}
          <code>{{ require.name }}</code>
        {% endif %}
        {% if require.description %}
          &mdash; {{ require.description }}
        {% endif %}
      </li>
    {% else %}
      <li class="item-description">
        <code>[{{ require.item.context.type }}]</code>
        <a href="{{ require.item.group }}.html#{{ require.item.context.type }}--{{ require.item.context.name }}">{{ require.item.context.name }}</a>

        {% if require.description %}
          &mdash; {{ require.description }}
        {% endif %}
      </li>
    {% endif %}
  {% endfor %}

  {% endif %}
{%- endmacro %}


{% macro examples(examples_list) %}
  {% for example in examples_list %}
    <div data-sassdoc="example">
      <strong data-sassdoc="example-subtitle">code example [{{ example.type }}]:</strong>

      {% if example.description %}
        <p data-sassdoc="example-description">{{ example.description|safe }}</p>
      {% endif %}

      {{ code_block(
        language=example.type,
        content=example.code|escape|safe
        ) }}

      {% if example.rendered %}
        <strong data-sassdoc="example-subtitle">rendered output:</strong>
        <div data-sassdoc="example-preview">{{ example.rendered|safe }}</div>
      {% endif %}
    </div>
  {% endfor %}
{% endmacro %}
