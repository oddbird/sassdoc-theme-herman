{% macro code_block(language=none, content=none) %}
  {% set content = content if (content != none) else caller() %}
  {% set language = ['lang', language]|join('-') if language != none %}
  <pre data-sassdoc="hljs"><code{% if language %} class="{{ language }}"{% endif %}>{{ content }}</code></pre>
{% endmacro %}


{% macro source(item, type) %}
{%- call code_block(language='scss') -%}
  {%- if (type == 'variable') -%}
    {{ scss_variable(item) }}
  {%- elif (type == 'css') -%}
    {{ scss_css(item) }}
  {%- elif (type == 'function') or (type == 'mixin') -%}
    {{ scss_function_or_mixin(item) }}
  {%- endif -%}
{%- endcall -%}
{% endmacro %}


{% macro scss_variable(item) -%}
${{ item.context.name }}: {{ item.context.value }}{% if item.context.scope != 'private' %} !{{ item.context.scope }}{% endif %};
{%- endmacro %}


{% macro scss_function_or_mixin(item) -%}
@{{ item.context.type }} {{ item.context.name }}{% if item.parameter %}(
{%- for parameter in item.parameter %}
  ${{ parameter.name }}{% if parameter.type|lower == "arglist" %}...{% elif parameter.default %}: {{ parameter.default }}{% endif %}{% if not loop.last %},{% endif %}
{%- endfor %}
){% endif %} { /* ... */ }
{%- endmacro %}


{%- macro scss_css(item) -%}
{{ item.context.name }} {
  {{ item.context.value }}
}
{%- endmacro -%}


{% macro examples(examples_list) %}
  {% for example in examples_list %}
    <div data-sassdoc="example">
      <strong data-sassdoc="example-subtitle">code example [{{ example.type }}]:</strong>

      {% if example.description %}
        <p data-sassdoc="example-description">{{ example.description|safe }}</p>
      {% endif %}

      {{ code_block(
        language=example.type,
        content=example.code|escape|safe
        ) }}

      {% if example.rendered %}
        <strong data-sassdoc="example-subtitle">rendered output:</strong>
        <div data-sassdoc="example-preview">{{ example.rendered|safe }}</div>
      {% endif %}
    </div>
  {% endfor %}
{% endmacro %}
