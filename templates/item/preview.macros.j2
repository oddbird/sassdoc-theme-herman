{% macro show_previews(data, name, args) %}
  {% if args %}
    {% set type = args[0] %}
    {% set key = name %}

    {% for spec in args %}
      {% set spec = spec|split(' ') %}
      {% set key = spec[1] if (spec[0] == 'key') else key %}
    {% endfor %}

    {% if type == 'color-palette' %}
      {{ color_palette(data[key]) }}
    {% elif type == 'font-specimen' %}
      {{ font_specimen(key, data, args) }}
    {% elif type == 'ratios' %}
      {{ ratios(data[key]) }}
    {% elif type == 'sizes' %}
      {{ sizes(data[key]) }}
    {% endif %}

  {% endif %}
{% endmacro %}


{% macro color_palette(data) %}
<div data-sassdoc="color-palette">
  {% for name, value in data %}
    <div data-sassdoc-color="{{ name }}">
      <div data-sassdoc="color-swatch" style="background-color: {{ value }};"></div>
      <div data-sassdoc="color-info">
        <strong data-sassdoc="color-name">{{ name }}</strong>
        <span data-sassdoc="color-value">{{ value }}</span>
      </div>
    </div>
  {% endfor %}
</div>
{% endmacro %}


{% macro font_specimen(name, data, args) %}
  {% set fonts_data = data[name] %}
  {% set sizes_key = none %}

  {% for pair in args %}
    {% set pair = pair|split(' ') %}
    {% set sizes_key = pair[1] if (pair[0] == 'sizes') else sizes_key %}
  {% endfor %}

  {% set sizes = data[sizes_key] or {'root': '16px'} %}

  <div data-sassdoc-font="{{ name }}">
    <div data-sassdoc="font-family">
      <h3 data-sassdoc="font-type">{{ name }}</h3>
      {% if fonts_data.stack %}
        <div data-sassdoc="font-stack">
          {% if fonts_data.name %}
            {% if fonts_data.source %}
              <a href="{{ fonts_data.source }}" data-sassdoc="font-name">{{ fonts_data.name }}</a>,
            {% else %}
              <span data-sassdoc="font-name">{{ fonts_data.name }}</span>,
            {% endif %}
          {% endif %}
          {% for item in fonts_data.stack %}
            {{ item }}{% if not loop.last %},{% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>

    {% set weight_options = [
      '100', '200', '300', '400', '500', '600', '700', '800', '900', 'bold'
    ] %}
    {% set style_options = [
      'italic', 'oblique'
    ] %}

    {% for options, value in fonts_data %}
      {% set options = options|split(' ') %}
      {% set face = value if (options[0] in weight_options or options[0] in style_options) else none %}
      {% set weight = 'normal' %}
      {% set style = 'normal' %}

      {% for value in options %}
        {% set weight = value if (value in weight_options) else weight %}
        {% set style = value if (value in style_options) else style %}
      {% endfor %}

      {% if face %}
        <div data-specimen-face="{{ face }}">
          <h4 data-sassdoc="specimen-title">{{ face }}</h4>
          {% for size, length in sizes %}
            <div data-specimen-size="{{ size }}">
              <div data-sassdoc="specimen-size">
                {% set format_length = ['0', length]|join('') if (length[0] == '.') else length %}
                {{ size }} · {{ format_length }}
              </div>
              <div data-sassdoc="specimen-text" style="font-size: {{ length }}; font-style: {{ style }}; font-weight: {{ weight }};">
                {{ lorem('body' if (size == 'root') else 'title') }}
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endfor %}
  </div>
{% endmacro %}


{% macro lorem(length) %}
  {% if length == 'title' %}
    Pack my box with five dozen liquor jugs.
  {% elif length == 'body' %}
    A wonderful serenity has taken possession of my entire soul, like these sweet mornings of spring which I enjoy with my whole heart. I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine. I am so happy, my dear friend, so absorbed in the exquisite sense of mere tranquil existence, that I neglect my talents. I should be incapable of drawing a single stroke at the present moment; and yet I feel that I never was a greater artist than now.
  {% endif %}
{% endmacro %}


{% macro ratios(data) %}
  {% for name, value in data %}
    <div data-sassdoc="ratio-preview">
      <div data-sassdoc="ratio-name">{{ name }} · {{ value }}</div>
      <div data-sassdoc="size-demos">
        {% for demo in range(6) %}
          {% set demo = 1 * (value ** demo) + 'em' %}
          {{ size_demo(demo) }}
        {% endfor %}
      </div>
    </div>
  {% endfor %}
{% endmacro %}


{% macro sizes(data) %}
  <div data-sassdoc="size-demos">
    {% for name, value in data %}
      {{ size_demo(value) }}
    {% endfor %}
  </div>
{% endmacro %}


{% macro size_demo(size) %}
  <div data-sassdoc="size-demo" style="width: {{ size }}; height: {{ size }}"></div>
{% endmacro %}


{% macro icons(list) %}
  {% if item.icons %}
    <div data-sassdoc="icon-preview">
      {% for icon in list %}
        <div data-sassdoc-icon="{{ icon.name }}">
          {{ icon.rendered|safe }}
          <div data-sassdoc="icon-info">
            <div data-sassdoc="icon-name">{{ icon.name }}</div>
            <div data-sassdoc="icon-path">{{ icon.path }}</div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endmacro %}
